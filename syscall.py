# Syscall functions for the Windows Malware Emulator

default_ret_code = 0x0

def __set_app_type(args):
    at = int(args[0], 16)
    if at == 0:
        app_type = 'at=UNKNWON_APP'
    elif at == 1:
        app_type = 'at=CONSOLE_APP'
    elif at == 2:
        app_type = 'at=GUI_APP'
    else:
        app_type = 'at=INVALID_VALUE'
    ret_args = [app_type]
    return default_ret_code, ret_args

def GetStartupInfoA(args):
    lpStartupInfo = int(args[0], 16)
    ret_code = None
    return ret_code, 'lpStartupInfo=' + hex(lpStartupInfo)

def GetModuleHandleA(args):
    lpModuleName = int(args[0], 16)
    return default_ret_code, 'lpModuleName=' + hex(lpModuleName)

